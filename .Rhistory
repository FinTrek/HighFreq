?poisson
?rpois
rpois(n=10, lambda=4)
rpois(n=10, lambda=10)/10
runif(n=10)
ls()
length(in_dex)
ta_q <- xts(exp(cumsum(0.001*rnorm(length(in_dex)))), order.by=in_dex)
chart_Series(ta_q)
bid_offer <- 0.001*(1 + runif(length(in_dex)))/2
ta_q <- merge(ta_q*(1-bid_offer), ta_q*(1+bid_offer))
tail(ta_q)
head(ta_q)
r_unif <- runif(length(in_dex))
traded_price <- r_unif*ta_q[, 1] + (1-r_unif)*ta_q[, 2]
ta_q <- merge(ta_q, traded_price)
tail(ta_q)
head(ta_q)
ta_q <- merge(ta_q, sample(x=10*(2:18), size=length(in_dex), replace=TRUE))
colnames(ta_q) <- c("Bid.Price", "Ask.Price", "Trade.Price", "Volume")
head(ta_q)
tail(ta_q)
foo <- scrub_TAQ(ta_q)
ohlc_data <- scrub_agg(ta_q, period="10 min")
chartSeries(ohlc_data, name=SPY, theme=chartTheme("white"))
head(ohlc_data)
x11()
chart_Series(ohlc_data, name=SPY)
oh_lc <- ohlc_data
library(HighFreq)
library(HighFreq)
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
x_ts <- run_variance(SPY)
in_dex <- format(index(x_ts), "%H:%M")
var_seasonal <- season_ality(x_ts=x_ts)
x11()
chart_Series(x=var_seasonal,
name=paste(colnames(var_seasonal), "daily seasonality"))
x_ts <- x_ts[!in_dex=="09:31", ]
var_seasonal <- season_ality(x_ts=x_ts)
chart_Series(x=var_seasonal,
name=paste(colnames(var_seasonal), "daily seasonality"))
prices_rolling <- roll_vwap(oh_lc=SPY, win_dow=11)
prices_rolling <- roll_vwap(oh_lc=SPY["2013-11"], win_dow=11)
chart_Series(SPY["2013-11-12"], name="SPY prices")
add_TA(prices_rolling["2013-11-12"], on=1, col="red", lwd=2)
prices_rolling <- roll_vwap(oh_lc=SPY["2013-11"], win_dow=11)
chart_Series(SPY["2013-11-12"], name="SPY prices")
add_TA(prices_rolling["2013-11-12"], on=1, col="red", lwd=2)
legend("top", legend=c("SPY prices", "VWAP prices"),
bg="white", lty=c(1, 1), lwd=c(2, 2),
col=c("black", "red"), bty="n")
chart_Series(SPY["2013-11-12"], name="SPY prices")
add_TA(prices_rolling["2013-11-12"], on=1, col="red", lwd=2)
legend("top", legend=c("SPY prices", "VWAP prices"),
bg="white", col=c("black", "red"), bty="n")
chart_Series(SPY["2013-11-12"], name="SPY prices")
add_TA(prices_rolling["2013-11-12"], on=1, col="red", lwd=2)
legend("topright", legend=c("SPY prices", "VWAP prices"),
bg="white", lty=c(1, 1), lwd=c(2, 2),
col=c("black", "red"), bty="n")
chart_Series(SPY["2013-11-12"], name="SPY prices")
add_TA(prices_rolling["2013-11-12"], on=1, col="red", lwd=2)
legend("top", legend=c("SPY prices", "VWAP prices"),
bg="white", lty=c(1, 1), lwd=c(2, 2),
col=c("black", "red"), bty="n")
library(HighFreq)
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
oh_lc <- scrub_agg(ta_q=get(sym_bol))
sym_bol <- "SPY"
oh_lc <- scrub_agg(ta_q=get(sym_bol))
oh_lc <- scrub_agg(ta_q=ta_q)
ls()
load(file.path(data_dir,
paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")))
data_dir <- "C:/Develop/data/hfreq/src/"
output_dir <- "C:/Develop/data/hfreq/scrub/"
load(file.path(data_dir,
paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")))
ls()
head(SPY)
sym_bol <- load(file.path(data_dir,
paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")))
sym_bol
sym_bol <- load(file.path(data_dir,
paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")))
ta_q <- scrub_TAQ(ta_q=get(sym_bol))
returns_running <- run_returns(x_ts=ta_q)
head(returns_running)
oh_lc <- scrub_agg(ta_q=ta_q)
inter_val <- "2013-11-11/2013-11-15"
x11()
chart_Series(oh_lc[inter_val], name=sym_bol)
foo <- oh_lc[inter_val]
head(foo)
foo
foo <- oh_lc[inter_val]
foo
head(oh_lc)
inter_val <- "2012-11-15/2012-11-17"
chart_Series(oh_lc[inter_val], name=sym_bol)
foo <- oh_lc[inter_val]
head(foo)
foo
rm(foo)
inter_val <- "2012-11-17/2012-11-19"
foo <- oh_lc[inter_val]
head(foo)
dim(oh_lc)
chart_Series(oh_lc, name=sym_bol)
paste0(sym_bol, ".Volume")
volume_daily <- xts::apply.daily(x=Vo(get(sym_bol)), FUN=sum)
colnames(volume_daily) <- paste0(sym_bol, ".Volume")
head(volume_daily)
var_daily <- xts::apply.daily(x=get(sym_bol), FUN=agg_regate, mo_ment="run_variance", calc_method="rogers.satchell")
colnames(var_daily) <- paste0(sym_bol, ".Var")
head(var_daily)
tail(var_daily)
rm(SPY)
var_daily <- xts::apply.daily(x=get(sym_bol), FUN=agg_regate, mo_ment="run_variance", calc_method="rogers.satchell")
colnames(var_daily) <- paste0(sym_bol, ".Var")
head(var_daily)
skew_daily <- xts::apply.daily(x=get(sym_bol), FUN=agg_regate, mo_ment="run_skew")
skew_daily <- skew_daily/(var_daily)^(1.5)
colnames(skew_daily) <- paste0(sym_bol, ".Skew")
chart_Series(skew_daily[inter_val], name=paste(sym_bol, "Skew"))
inter_val <- "2013-10/2013-12"
chart_Series(skew_daily[inter_val], name=paste(sym_bol, "Skew"))
win_dow <- 10
prices_rolling <- rutils::roll_sum(get(sym_bol)[, 1], win_dow=win_dow)/win_dow
colnames(prices_rolling) <- paste0(sym_bol, ".Rets")
colnames(prices_rolling) <- paste0(sym_bol, ".Prices")
chart_Series(get(sym_bol)["2013-11-12"], name=paste(sym_bol, "Prices"))
add_TA(prices_rolling["2013-11-12"], on=1, col="red", lwd=2)
legend("top", legend=c("SPY prices", "average prices"),
bg="white", lty=c(1, 1), lwd=c(2, 2),
col=c("black", "red"), bty="n")
library(HighFreq)
sym_bol <- SPY
win_dow <- 10
prices_rolling <- rutils::roll_sum(Cl(get(sym_bol)), win_dow=win_dow)/win_dow
foo <- Cl(get(sym_bol))
foo <- get(sym_bol)
sym_bol
sym_bol <- SPY
prices_rolling <- rutils::roll_sum(Cl(get(sym_bol)), win_dow=win_dow)/win_dow
sym_bol
sym_bol <- "SPY"
win_dow <- 10
prices_rolling <- rutils::roll_sum(Cl(get(sym_bol)), win_dow=win_dow)/win_dow
colnames(prices_rolling) <- paste0(sym_bol, ".Prices")
chart_Series(get(sym_bol)["2013-11-12"], name=paste(sym_bol, "Prices"))
add_TA(prices_rolling["2013-11-12"], on=1, col="red", lwd=2)
legend("top", legend=c("SPY prices", "average prices"),
bg="white", lty=c(1, 1), lwd=c(2, 2),
col=c("black", "red"), bty="n")
prices_rolling <- roll_vwap(oh_lc=get(sym_bol)["2013-11-12"], x_ts=Cl, win_dow=win_dow)
prices_rolling <- roll_vwap(oh_lc=get(sym_bol)["2013-11-12"], win_dow=win_dow)
x11()
colnames(prices_rolling) <- paste0(sym_bol, ".Prices")
chart_Series(get(sym_bol)["2013-11-12"], name=paste(sym_bol, "Prices"))
add_TA(prices_rolling["2013-11-12"], on=1, col="red", lwd=2)
legend("top", legend=c("SPY prices", "average prices"),
bg="white", lty=c(1, 1), lwd=c(2, 2),
col=c("black", "red"), bty="n")
var_running <- run_variance(oh_lc=SPY)
var_rolling <- roll_vwap(oh_lc=SPY, x_ts=var_running, win_dow=win_dow)
colnames(var_rolling) <- paste0(sym_bol, ".Var")
head(var_rolling)
skew_rolling <- roll_vwap(oh_lc=SPY, x_ts=skew_running, win_dow=win_dow)
skew_running <- run_skew(oh_lc=SPY)
skew_rolling <- roll_vwap(oh_lc=SPY, x_ts=skew_running, win_dow=win_dow)
colnames(var_rolling) <- paste0(sym_bol, ".Skew")
skew_rolling <- roll_vwap(oh_lc=SPY, x_ts=skew_running, win_dow=win_dow)
skew_rolling <- skew_rolling/(var_rolling)^(1.5)
sum(skew_rolling)
sum(is.na(skew_rolling))
which(is.na(skew_rolling))
skew_rolling[97115:97125]
skew_rolling <- ifelse(var_rolling>0, skew_rolling/(var_rolling)^(1.5), 0)
sum(is.na(skew_rolling))
colnames(var_rolling) <- paste0(sym_bol, ".Skew")
chart_Series(var_rolling["2013-11-12"], name=paste(sym_bol, "Rolling Variance"))
chart_Series(skew_rolling["2013-11-12"], name=paste(sym_bol, "Rolling Skew"))
library(HighFreq)
volume_seasonal <- season_ality(Vo(get(sym_bol)))
colnames(volume_seasonal) <- paste0(sym_bol, ".volume_seasonal")
chart_Series(volume_seasonal, name=paste(sym_bol, "daily seasonality of trading volumes"))
x11()
chart_Series(volume_seasonal, name=paste(sym_bol, "daily seasonality of trading volumes"))
var_seasonal <- season_ality(run_variance(oh_lc=get(sym_bol))
)
colnames(var_seasonal) <- paste0(sym_bol, ".var_seasonal")
chart_Series(var_seasonal, name=paste(sym_bol, "daily seasonality of variance"))
?apply_rolling
sym_bol <- "SPY"
data_dir <- "C:/Develop/data/hfreq/src/"
output_dir <- "C:/Develop/data/hfreq/scrub/"
ls()
sym_bol <- load(file.path(data_dir,
paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")))
ls()
x_ts <- get(sym_bol)[!extreme_values(Cl(get(sym_bol)), vol_mult=1.0)]
head(get(sym_bol))
ls()
rm(ls=ls())
rm(list=ls())
sym_bol <- "SPY"
sym_bol <- load(file.path(data_dir,
paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")))
data_dir <- "C:/Develop/data/hfreq/src/"
output_dir <- "C:/Develop/data/hfreq/scrub/"
sym_bol <- "SPY"
sym_bol <- load(file.path(data_dir,
paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")))
ls()
head(SPY)
SPY_2014_05_02 <- SPY
rm(SPY)
save(c("SPY", "SPY_2014_05_02", "TLT", "VXX"), file="C:/Develop/R/HighFreq/data/hf_data.RData")
?save
save(list=c("SPY", "SPY_2014_05_02", "TLT", "VXX"), file="C:/Develop/R/HighFreq/data/hf_data.RData")
SPY_TAQ <- SPY_2014_05_02
rm(SPY_2014_05_02)
save(list=c("SPY", "SPY_TAQ", "TLT", "VXX"), file="C:/Develop/R/HighFreq/data/hf_data.RData")
foo <- extreme_values(SPY_TAQ, vol_mult=1.0)
head(SPY_TAQ)
x_ts <- SPY_TAQ
vol_mult <- 1
win_dow <- 31
vo_lat <- caTools::runquantile(x=abs(as.vector(x_ts)), k=win_dow,
probs=0.9, endrule="constant", align="center")
head(vo_lat)
length(vo_lat)
NROW(x_ts)
mid_prices <- 0.5 * (SPY_TAQ[, "Bid.Price"] + SPY_TAQ[, "Ask.Price"])
win_dow
vol_mult
price_jumps(mid_prices, win_dow=win_dow, vol_mult=vol_mult)
foo <- price_jumps(mid_prices, win_dow=win_dow, vol_mult=vol_mult)
foo[foo]
ta_q <- SPY_TAQ
mid_prices <- 0.5 * (ta_q[, "Bid.Price"] + ta_q[, "Ask.Price"])
ta_q[price_jumps(mid_prices, win_dow=win_dow, vol_mult=vol_mult), ] <- NA
ta_q <- na.locf(ta_q)
mid_prices <- 0.5 * (ta_q[, "Bid.Price"] + ta_q[, "Ask.Price"])
foo <- price_jumps(mid_prices, win_dow=win_dow, vol_mult=vol_mult)
foo[foo]
file_name <- paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")
file_name
output_dir <- "C:/Develop/data/hfreq/scrub/"
output_dir <- "C/Users/Jerzy/Downloads"
output_dir <- "C:/Users/Jerzy/Downloads"
sym_bol <- "SPY"
file_name <- paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")
ls()
sym_bol <- load(file.path(data_dir, paste0(sym_bol, "/2014.05.02.", sym_bol, ".RData")))
sym_bol
ls()
ta_q <- scrub_TAQ(ta_q=get(sym_bol))
output_dir
save(list=sym_bol, file=file.path(output_dir, file_name))
file_name_out <- file.path(output_dir, file_name)
save(list=sym_bol, file=file.path(output_dir, file_name))
file_name_out
file.path(output_dir, file_name)
save(sym_bol, file=file.path(output_dir, file_name))
sym_bol
save(get(sym_bol), file=file.path(output_dir, file_name))
save(list=get(sym_bol), file=file.path(output_dir, file_name))
save(list=sym_bol, file=file.path(output_dir, file_name))
?save
save(list=eval(sym_bol), file=file.path(output_dir, file_name))
foo <- eval("SPY")
head(foo)
foo
save(list=sym_bol, file=file.path(output_dir, file_name))
?roll_vwap
# load HighFreq
library(HighFreq)
sym_bol <- "SPY"
# rolling volume-weighted average prices
win_dow <- 21
var_running <- run_variance(oh_lc=SPY)
# calculate rolling SPY variance
var_rolling <- roll_vwap(oh_lc=SPY, x_ts=var_running, win_dow=win_dow)
colnames(var_rolling) <- paste0(sym_bol, ".Var")
skew_running <- run_skew(oh_lc=SPY)
skew_rolling <- roll_vwap(oh_lc=SPY, x_ts=skew_running, win_dow=win_dow)
skew_rolling <- ifelse(var_rolling>0, skew_rolling/(var_rolling)^(1.5), 0)
colnames(skew_rolling) <- paste0(sym_bol, ".Skew")
foo <- skew_rolling
x11()
chart_Series(skew_rolling["2013-11-12"], name=paste(sym_bol, "Rolling Skew"))
dim(skew_rolling)
head(skew_rolling)
sum(is.na(skew_rolling))
tail(skew_rolling)
head(var_rolling)
tail(var_rolling)
sum(var_rolling)
ls()
head(SPY)
rm(SPY)
var_running <- run_variance(oh_lc=SPY)
var_rolling <- roll_vwap(oh_lc=SPY, x_ts=var_running, win_dow=win_dow)
colnames(var_rolling) <- paste0(sym_bol, ".Var")
skew_running <- run_skew(oh_lc=SPY)
skew_rolling <- roll_vwap(oh_lc=SPY, x_ts=skew_running, win_dow=win_dow)
skew_rolling <- ifelse(var_rolling>0, skew_rolling/(var_rolling)^(1.5), 0)
colnames(skew_rolling) <- paste0(sym_bol, ".Skew")
chart_Series(skew_rolling["2013-11-12"], name=paste(sym_bol, "Rolling Skew"))
x11()
foo <- skew_rolling
var_rolling <- roll_moment(oh_lc=SPY, win_dow=win_dow)
skew_rolling <- roll_moment(oh_lc=SPY, mo_ment="run_skew", win_dow=win_dow)
skew_rolling <- ifelse(var_rolling>0, skew_rolling/(var_rolling)^(1.5), 0)
chart_Series(skew_rolling["2013-11-12"], name=paste(sym_bol, "Rolling Skew"))
foo <- merge(foo, skew_rolling)
head(foo)
tail(foo)
x_ts <- SPY["2012-02-13"]
win_dow <- 11
agg_regations <- roll_apply(x_ts, agg_fun=sum, win_dow=win_dow, by_columns=TRUE)
agg_regations <- roll_apply(x_ts, agg_fun=sum, win_dow=win_dow, by_columns=TRUE)
agg_function <- function(x_ts)  c(max(x_ts[, 2]), min(x_ts[, 3]))
agg_regations <- roll_apply(x_ts, agg_fun=agg_function, win_dow=win_dow)
head(agg_regations)
end_points <- rutils::end_points(x_ts, inter_val=win_dow)
end_points
agg_regations <- roll_apply(x_ts, agg_fun=sum, win_dow=2, end_points=end_points, by_columns=TRUE)
head(agg_regations)
agg_regations <- roll_apply(x_ts, agg_fun=agg_function, win_dow=2, end_points=end_points)
head(agg_regations)
ls()
library(HighFreq)
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
Sys.glob("*.Rmd")
getwd()
sapply(Sys.glob("*.Rmd"),
function(x) rmarkdown::render(input=file.path(getwd(), x), clean=FALSE)
)  # end sapply
library(HighFreq)
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
library(quantmod)
quantmod::getSymbols("XOM")
ls()
head(XOM)
library(HighFreq)
foo <- adjust_ohlc(XOM)
head(XOM[, 1:4])
foo <- XOM
foo[, 1:4] <- foo[, 6] / foo[, 4] * foo[, 1:4]
foo <- foo[, 6] / foo[, 4]
head(foo)
foo <- XOM
foo <- coredata(foo[, 6] / foo[, 4]) * coredata(foo[, 1:4])
head(coredata(foo[, 6] / foo[, 4]))
head(coredata(foo[, 1:4]))
head(t(coredata(foo[, 1])))
head(t(coredata(foo[1:11, 1])))
head(t(foo[1:11, 1]))
class(t(foo[1:11, 1]))
vec_tor <- c(2, 1, 3)
mat_rix <- matrix(sample(1:12), ncol=3)
vec_tor
mat_rix
vec_tor*mat_rix
mat_rix*vec_tor
vec_tor <- c(2, 4, 3)
vec_tor*mat_rix
mat_rix*vec_tor
vec_tor
mat_rix
oh_lc <- XOM
adj_vector <- coredata(oh_lc[, 6] / oh_lc[, 4])
head(adj_vector)
oh_lc[, 1:4] <- adj_vector * oh_lc[, 1:4]
oh_lc[, 1:4] <- adj_vector * coredata(oh_lc[, 1:4]()
)
oh_lc <- XOM
adj_vector <- coredata(oh_lc[, 6] / oh_lc[, 4])
oh_lc[, 1:4] <- adj_vector * coredata(oh_lc[, 1:4])
head(coredata(oh_lc[, 1:4]))
head(adj_vector)
adj_vector <- as.vector(oh_lc[, 6] / oh_lc[, 4])
head(adj_vector)
oh_lc[, 1:4] <- adj_vector * coredata(oh_lc[, 1:4])
head(oh_lc)
head(XOM)
tail(oh_lc)
tail(XOM)
library(HighFreq)
vec_tor1 <- 1:3
mat_rix <- matrix(sample(1:12), ncol=3)
vec_tor1 * mat_rix
vec_tor1
mat_rix
vec_tor1 * mat_rix
vec_tor1 <- c(2, 4, 3)
vec_tor1
mat_rix
vec_tor1 * mat_rix
vec_tor1 * t(mat_rix)
t(vec_tor1 * t(mat_rix))
Sys.Date()
?mget
get_symbols <- function(sym_bols,
env_out,
start_date="2007-01-01",
end_date=Sys.Date()) {
getSymbols.yahoo(sym_bols,
env=env_out,
from=start_date,
to=end_date)
# scrub and aggregate the TAQ data
out_put <- lapply(sym_bols,
function(sym_bol) {
assign(sym_bol,
adjust_ohlc(get(sym_bol, envir=env_out)),
envir=env_out)
sym_bol
}
)  # end lapply
invisible(out_put)
}  # end get_symbols
ls()
new_env <- new.env()
get_symbols(
sym_bols=c("MSFT", "XOM"),
env_out=new_env,
start_date="20012-12-01",
end_date="2015-12-01")
}
getSymbols.yahoo(c("MSFT", "XOM"), env=new_env)
ls(new_env)
rm(new_env)
adjust_ohlc <- function(oh_lc) {
# adjust OHLC prices
oh_lc[, 1:4] <- as.vector(oh_lc[, 6] / oh_lc[, 4]) * coredata(oh_lc[, 1:4])
oh_lc
}  # end adjust_ohlc
get_symbols <- function(sym_bols,
env_out,
start_date="2007-01-01",
end_date=Sys.Date()) {
getSymbols.yahoo(sym_bols,
env=env_out,
from=start_date,
to=end_date)
# adjust the OHLC data
out_put <- lapply(sym_bols,
function(sym_bol) {
assign(sym_bol,
value=adjust_ohlc(get(sym_bol, envir=env_out)),
envir=env_out)
sym_bol
}
)  # end lapply
invisible(out_put)
}  # end get_symbols
new_env <- new.env()
get_symbols(
sym_bols=c("MSFT", "XOM"),
env_out=new_env,
start_date="20012-12-01",
end_date="2015-12-01")
debug(get_symbols)
get_symbols(
sym_bols=c("MSFT", "XOM"),
env_out=new_env,
start_date="20012-12-01",
end_date="2015-12-01")
get_symbols(
sym_bols=c("MSFT", "XOM"),
env_out=new_env,
start_date="20012-12-01",
end_date="2015-12-01")
sym_bols
env_out
start_date
end_date
get_symbols(
sym_bols=c("MSFT", "XOM"),
env_out=new_env,
start_date="2012-12-01",
end_date="2015-12-01")
out_put
undebug(get_symbols)
ls()
head(XOM)
head(oh_lc)
head(new_env$XOM)
oh_lc <- adjust_ohlc("XOM")
adjust_ohlc
oh_lc <- adjust_ohlc(XOM)
head(XOM)
head(oh_lc)
rm(new_env)
new_env <- new.env()
get_symbols(
sym_bols=c("MSFT", "XOM"),
env_out=new_env)
head(new_env$XOM)
get_symbols(
sym_bols="LOW",
env_out=new_env)
head(new_env$LOW)
library(HighFreq)
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
library(HighFreq)
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
