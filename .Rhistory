arma=roll_wsum_armaa(vec_tor, rev(wei_ghts)),
r_code=filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1, circular=TRUE),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
foo <- roll_wsum_armaa(vec_tor, rev(wei_ghts))
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/roll_wsum.cpp")
library(HighFreq)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/roll_wsum.cpp")
wei_ghts <- exp(-0.2*1:11)
wei_ghts <- wei_ghts/sum(wei_ghts)
vec_tor <- as.numeric(rutils::env_etf$VTI[, 6])
foo <- roll_wsum_armaa(vec_tor, rev(wei_ghts))
rev(wei_ghts)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/roll_wsum.cpp")
foo <- roll_wsum_armaa(vec_tor, rev(wei_ghts))
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/roll_wsum.cpp")
foo <- roll_wsum_armaa(vec_tor, rev(wei_ghts))
weight_ed <- HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=wei_ghts)
filter_ed <- foo
round(as.numeric(tail(weight_ed, 22)), 2)
round(as.numeric(tail(filter_ed, 22)), 2)
round(as.numeric(head(weight_ed, 22)), 2)
round(as.numeric(head(filter_ed, 22)), 2)
library(microbenchmark)
summary(microbenchmark(
rcpp=HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=wei_ghts),
arma=roll_wsum_armaa(vec_tor, rev(wei_ghts)),
r_code=filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1, circular=TRUE),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
all.equal(as.numeric(filter_ed), as.numeric(weight_ed))
round(as.numeric(tail(weight_ed, 22)), 4)
round(as.numeric(tail(filter_ed, 22)), 4)
weight_ed <- HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=wei_ghts)
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(filter_ed[-(1:11)]), as.numeric(weight_ed[-(1:11)]))
432.2775/64.5125
library(HighFreq)
vec_tor <- as.numeric(rutils::env_etf$VTI[, 6])
wei_ghts <- exp(-0.2*1:11)
wei_ghts <- wei_ghts/sum(wei_ghts)
weight_ed <- HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=wei_ghts)
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(filter_ed[-(1:11)]), as.numeric(weight_ed[-(1:11)]))
round(as.numeric(tail(weight_ed, 22)), 2)
round(as.numeric(tail(filter_ed, 22)), 2)
wei_ghts <- c(1, rep(1e-5, 10))
weight_ed <- HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=wei_ghts)
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(vec_tor), as.numeric(weight_ed))
round(as.numeric(tail(weight_ed, 22)), 2)
round(as.numeric(tail(vec_tor, 22)), 2)
round(as.numeric(head(vec_tor, 22)), 2)
round(as.numeric(head(weight_ed, 22)), 2)
weight_ed <- HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=rev(wei_ghts))
round(as.numeric(head(vec_tor, 22)), 2)
round(as.numeric(head(weight_ed, 22)), 2)
round(as.numeric(tail(vec_tor, 22)), 2)
round(as.numeric(tail(weight_ed, 22)), 2)
all.equal(as.numeric(filter_ed[-(1:11)]), as.numeric(weight_ed[-(1:11)]))
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(filter_ed[-(1:11)]), as.numeric(weight_ed[-(1:11)]))
library(microbenchmark)
summary(microbenchmark(
rcpp=HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=wei_ghts),
r_code=filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1, circular=TRUE),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
408.5740/67.4445
wei_ghts
wei_ghts <- exp(-0.2*1:11)
wei_ghts <- wei_ghts/sum(wei_ghts)
weight_ed <- HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=rev(wei_ghts))
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(filter_ed[-(1:11)]), as.numeric(weight_ed[-(1:11)]))
all.equal(as.numeric(filter_ed), as.numeric(weight_ed))
wei_ghts <- c(1, rep(0, 10))
weight_ed <- HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=rev(wei_ghts))
all.equal(vec_tor, as.numeric(weight_ed))
library(HighFreq)
summary(microbenchmark(
rcpp=HighFreq::roll_wsum(vec_tor=vec_tor, wei_ghts=wei_ghts),
r_code=filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1, circular=TRUE),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
2.1+e
r_norm <- rnorm(100)
ari_ma <- numeric(100)
ari_ma[5] <- 0
ari_ma <- numeric(100)
ari_ma[1] <- 5
co_eff <- 0.8
r_norm <- rnorm(100)
ari_ma <- numeric(100)
ari_ma[1] <- 5
co_eff <- 0.8
for (i in 2:100) z[i] <- co_eff*z[i-1] + r_norm[i]
for (i in 2:100) ari_ma[i] <- co_eff*ari_ma[i-1] + r_norm[i]
tail(ari_ma)
co_eff <- -0.8
for (i in 2:100) ari_ma[i] <- co_eff*ari_ma[i-1] + r_norm[i]
tail(ari_ma)
foo <- ari_ma
ari_ma[1] <- 5
for (i in 2:100) ari_ma[i] <- co_eff*ari_ma[i-1] + r_norm[i-1]
foo <- ari_ma
tail(foo)
ari_ma <- filter(c(5, r_norm), filter=co_eff, method="recursive")
all.equal(ari_ma, foo)
all.equal(as.numeric(ari_ma), foo)
tail(cbind(as.numeric(ari_ma), foo))
tail(cbind(as.numeric(ari_ma[-1]), foo))
head(cbind(as.numeric(ari_ma[-1]), foo))
all.equal(as.numeric(ari_ma[-100]), foo)
head(cbind(as.numeric(ari_ma[-100]), foo))
tail(cbind(as.numeric(ari_ma[-100]), foo))
all.equal(as.numeric(ari_ma[-(99:100)]), foo[-100])
tail(cbind(as.numeric(ari_ma[-(99:100)]), foo[-100]))
tail(cbind(as.numeric(ari_ma[-100]), foo))
tail(cbind(as.numeric(ari_ma[-(100:101)]), foo[-100]))
all.equal(as.numeric(ari_ma[-(100:101)]), foo[-100])
co_eff <- c(-0.8, 0.2)
ari_ma[1] <- 5
ari_ma <- numeric(100)
ari_ma[1] <- 5
ari_ma[2] <- co_eff[1]*ari_ma[1] r_norm[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + r_norm[1]
ari_ma[1]
ari_ma[2]
for (i in 3:100) ari_ma[i] <- co_eff[1]*ari_ma[i-1] + co_eff[2]*ari_ma[i-2] + r_norm[i-1]
foo <- ari_ma
ari_ma <- filter(c(5, r_norm), filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma[-(100:101)]), foo[-100])
tail(ari_ma)
?arima.sim
in_nov <- r_norm
rm(r_norm)
ari_ma <- numeric(NROW(in_nov))
co_eff <- -0.8
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(in_nov)) ari_ma[i] <- co_eff*ari_ma[i-1] + in_nov[i]
foo <- ari_ma
ari_ma <- filter(c(in_nov), filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma[-(100:101)]), foo[-100])
NROW(ari_ma)
NROW(foo)
all.equal(as.numeric(ari_ma), foo)
ari_ma <- filter(c(in_nov), filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(in_nov)) ari_ma[i] <- co_eff*ari_ma[i-1] + in_nov[i]
foo <- ari_ma
ari_ma <- filter(c(in_nov), filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma <- numeric(NROW(in_nov))
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(in_nov)) ari_ma[i] <- co_eff*ari_ma[i-1] + in_nov[i]
foo <- ari_ma
ari_ma <- filter(c(in_nov), filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
co_eff <- c(-0.8, 0.2)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in 3:100) ari_ma[i] <- co_eff[1]*ari_ma[i-1] + co_eff[2]*ari_ma[i-2] + in_nov[i-1]
foo <- ari_ma
ari_ma <- filter(c(5, in_nov), filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in 3:NROW(in_nov)) ari_ma[i] <- co_eff[1]*ari_ma[i-1] + co_eff[2]*ari_ma[i-2] + in_nov[i]
foo <- ari_ma
ari_ma <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma <- numeric(NROW(in_nov))
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-NROW(co_eff)):(i-1)] + in_nov[i]
}
foo <- ari_ma
ari_ma <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-NROW(co_eff)):(i-1)] + in_nov[i]
}
foo <- ari_ma
ari_ma <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in 3:NROW(in_nov)) {
ari_ma[i] <- co_eff[1]*ari_ma[i-1] + co_eff[2]*ari_ma[i-2] + in_nov[i]
}
foo <- ari_ma
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-NROW(co_eff)):(i-1)] + in_nov[i]
}
all.equal(as.numeric(ari_ma), foo)
co_eff
class(ari_ma)
tail(ari_ma)
head(ari_ma)
ari_ma[2:5]
ari_ma[5:2]
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}
all.equal(as.numeric(ari_ma), foo)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in 3:NROW(in_nov)) {
ari_ma[i] <- co_eff[1]*ari_ma[i-1] + co_eff[2]*ari_ma[i-2] + in_nov[i]
}
foo <- ari_ma
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
ari_ma[2] <- co_eff[1]*ari_ma[1] + in_nov[2]
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}
all.equal(as.numeric(ari_ma), foo)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(co_eff)) {
ari_ma[i] <- co_eff[1:(i-1)] %*% ari_ma[(i-1):1] + in_nov[i]
}
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}
foo <- ari_ma
ari_ma <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/sim_arima.cpp")
co_eff <- c(-0.8, 0.2)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(co_eff)) {
ari_ma[i] <- co_eff[1:(i-1)] %*% ari_ma[(i-1):1] + in_nov[i]
}
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}
foo <- ari_ma
ari_ma <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma <- sim_arima(in_nov, co_eff)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/sim_arima.cpp")
ari_ma <- sim_arima(in_nov, co_eff)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/sim_arima.cpp")
ari_ma <- sim_arima(in_nov, co_eff)
all.equal(as.numeric(ari_ma), foo)
co_eff <- c(-0.8, 0.2)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(co_eff)) {
ari_ma[i] <- co_eff[1:(i-1)] %*% ari_ma[(i-1):1] + in_nov[i]
}
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}
foo <- ari_ma
ari_ma <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma <- sim_arima(in_nov, rev(co_eff))
all.equal(as.numeric(ari_ma), foo)
bar <- cbind(as.numeric(ari_ma), foo)
tail(bar)
head(bar)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/sim_arima.cpp")
library(HighFreq)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/sim_arima.cpp")
co_eff <- c(-0.8, 0.2)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(co_eff)) {
ari_ma[i] <- co_eff[1:(i-1)] %*% ari_ma[(i-1):1] + in_nov[i]
}
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}
foo <- ari_ma
ari_ma <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
in_nov <- rnorm(100)
co_eff <- c(-0.8, 0.2)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(co_eff)) {
ari_ma[i] <- co_eff[1:(i-1)] %*% ari_ma[(i-1):1] + in_nov[i]
}
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}
foo <- ari_ma
ari_ma <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(ari_ma), foo)
ari_ma <- sim_arima(in_nov, rev(co_eff))
all.equal(as.numeric(ari_ma), foo)
bar <- cbind(as.numeric(ari_ma), foo)
tail(bar)
head(bar)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/sim_arima.cpp")
ari_ma <- sim_arima(in_nov, rev(co_eff))
all.equal(as.numeric(ari_ma), foo)
bar <- cbind(as.numeric(ari_ma), foo)
tail(bar)
head(bar)
ari_ma <- sim_arima(in_nov, co_eff)
all.equal(as.numeric(ari_ma), foo)
bar <- cbind(as.numeric(ari_ma), foo)
tail(bar)
head(bar)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/sim_arima.cpp")
ari_ma <- sim_arima(in_nov, rev(co_eff))
all.equal(as.numeric(ari_ma), foo)
library(microbenchmark)
summary(microbenchmark(
rcpp=sim_arima(in_nov, rev(co_eff)),
pure_r=filter(in_nov, filter=co_eff, method="recursive"),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
summary(microbenchmark(
rcpp=sim_arima(in_nov, rev(co_eff)),
pure_r=filter(in_nov, filter=co_eff, method="recursive"),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
83.5725/13.6850
?filter
filter_ed <- filter(in_nov, filter=co_eff, method="recursive")
ari_ma <- sim_arima(in_nov, rev(co_eff))
all.equal(as.numeric(ari_ma), as.numeric(filter_ed))
library(HighFreq)
co_eff <- c(-0.8, 0.2)
in_nov <- rnorm(100)
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(co_eff)) {
ari_ma[i] <- co_eff[1:(i-1)] %*% ari_ma[(i-1):1] + in_nov[i]
}  # end for
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}  # end for
filter_ed <- filter(in_nov, filter=co_eff, method="recursive")
all.equal(as.numeric(filter_ed), ari_ma)
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/sim_arima.cpp")
arima_rcpp <- sim_arima(in_nov, rev(co_eff))
all.equal(as.numeric(ari_ma), foo)
all.equal(as.numeric(ari_ma), ari_ma)
all.equal(as.numeric(arima_rcpp), ari_ma)
library(microbenchmark)
summary(microbenchmark(
rcpp=sim_arima(in_nov, rev(co_eff)),
pure_r=filter(in_nov, filter=co_eff, method="recursive"),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
81.1290/12.2185
fil_ter <- function(in_nov, co_eff) {
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(co_eff)) {
ari_ma[i] <- co_eff[1:(i-1)] %*% ari_ma[(i-1):1] + in_nov[i]
}  # end for
# remaining periods
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}  # end for
ari_ma
}  # end fil_ter
all.equal(as.numeric(filter_ed), ari_ma)
all.equal(filter_ed(in_nov, co_eff), ari_ma)
fil_ter <- function(in_nov, co_eff) {
ari_ma <- numeric(NROW(in_nov))
ari_ma[1] <- in_nov[1]
for (i in 2:NROW(co_eff)) {
ari_ma[i] <- co_eff[1:(i-1)] %*% ari_ma[(i-1):1] + in_nov[i]
}  # end for
# remaining periods
for (i in (NROW(co_eff)+1):NROW(in_nov)) {
ari_ma[i] <- co_eff %*% ari_ma[(i-1):(i-NROW(co_eff))] + in_nov[i]
}  # end for
ari_ma
}  # end fil_ter
all.equal(filter_ed(in_nov, co_eff), ari_ma)
all.equal(fil_ter(in_nov, co_eff), ari_ma)
summary(microbenchmark(
rcpp=sim_arima(in_nov, rev(co_eff)),
vectorized_r=filter(in_nov, filter=co_eff, method="recursive"),
pure_r=fil_ter(in_nov, co_eff)
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
summary(microbenchmark(
rcpp=sim_arima(in_nov, rev(co_eff)),
vectorized_r=filter(in_nov, filter=co_eff, method="recursive"),
pure_r=fil_ter(in_nov, co_eff),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
Rcpp::sourceCpp(file="C:/Develop/R/lecture_slides/assignments/roll_wsum.cpp")
wei_ghts <- c(1, rep(1e-5, 10))
wei_ghts <- c(1, rep(0, 10))
weight_ed <- roll_wsum(vec_tor=vec_tor, wei_ghts=rev(wei_ghts))
vec_tor <- as.numeric(rutils::env_etf$VTI[, 6])
weight_ed <- roll_wsum(vec_tor=vec_tor, wei_ghts=rev(wei_ghts))
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(vec_tor), as.numeric(weight_ed))
wei_ghts <- exp(-0.2*1:11)
wei_ghts <- wei_ghts/sum(wei_ghts)
weight_ed <- roll_wsum(vec_tor=vec_tor, wei_ghts=rev(wei_ghts))
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(filter_ed[-(1:10)]), as.numeric(weight_ed))
all.equal(as.numeric(filter_ed), as.numeric(weight_ed))
wei_ghts <- exp(-0.2*1:11)
wei_ghts <- wei_ghts/sum(wei_ghts)
weight_ed <- roll_wsum(vec_tor=vec_tor, wei_ghts=rev(wei_ghts))
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(filter_ed[-(1:10)]), as.numeric(weight_ed))
NROW(weight_ed)
NROW(filter_ed)
head(filter_ed, 14)
head(weight_ed, 14)
head(filter_ed, 14)
head(as.numeric(weight_ed), 14)
all.equal(as.numeric(filter_ed[-(1:10)]), as.numeric(weight_ed[-(1:10)]))
wei_ghts <- exp(-0.2*1:11)
wei_ghts <- wei_ghts/sum(wei_ghts)
weight_ed <- roll_wsum(vec_tor=vec_tor, wei_ghts=rev(wei_ghts))
filter_ed <- filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1)
all.equal(as.numeric(filter_ed[-(1:10)]), as.numeric(weight_ed[-(1:10)]))
library(microbenchmark)
summary(microbenchmark(
rcpp=roll_wsum(vec_tor=vec_tor, wei_ghts=wei_ghts),
pure_r=filter(x=vec_tor, filter=wei_ghts, method="convolution", sides=1, circular=TRUE),
times=10))[, c(1, 4, 5)]  # end microbenchmark summary
filter
Rcpp::sourceCpp(file="C:/Develop/R/lecture_slides/assignments/roll_wsum.cpp")
Rcpp::sourceCpp(file="C:/Develop/R/lecture_slides/assignments/roll_var.cpp")
library(microbenchmark)
library(microbenchmark)
class(re_turns)
class(vec_tor)
look_back
look_back <- 11
summary(microbenchmark(
rcpp=roll_var(vec_tor, look_back=look_back),
TTR=TTR::runSD(x=vec_tor, n=look_back),
times=10))[, c(1, 4, 5)]
11767.501/1130.957
vari_ance(rnorm(1000))
vari_ance(rnorm(1000))
in_nov <- rnorm(1000)
all.equal(var(in_nov), vari_ance(in_nov))
summary(microbenchmark(
rcpp=vari_ance(in_nov),
vectorized_r=var(in_nov),
times=10))[, c(1, 4, 5)]
summary(microbenchmark(
rcpp=vari_ance(in_nov),
vectorized_r=var(in_nov),
times=10))[, c(1, 4, 5)]
mat_rix <- matrix(rnorm(500), nc=5)
eigen_decomp <- get_eigen(scale(mat_rix, scale=FALSE))
Rcpp::sourceCpp(file="C:/Develop/R/Rcpp/get_eigen.cpp")
eigen_decomp <- get_eigen(scale(mat_rix, scale=FALSE))
reg_model <- prcomp(mat_rix)
all.equal(reg_model$sdev^2, drop(eigen_decomp$eigval))
all.equal(unname(reg_model$rotation), eigen_decomp$eigvec)
all.equal(unname(reg_model$rotation), -eigen_decomp$eigvec)
reg_model$rotation
unname(reg_model$rotation)
eigen_decomp$eigvec
all.equal(abs(unname(pc_a$rotation)), abs(eigen_decomp$eigvec))
pc_a <- prcomp(mat_rix)
all.equal(abs(unname(pc_a$rotation)), abs(eigen_decomp$eigvec))
in_verse <- HighFreq::inv_reg(mat_rix, max_eigen)
max_eigen <- 3
in_verse <- HighFreq::inv_reg(mat_rix, max_eigen)
library(HighFreq)
in_verse <- HighFreq::inv_reg(mat_rix, max_eigen)
eigen_decomp <- eigen(cov(mat_rix))
eigen_decomp
ei_gen$vectors
ei_gen <- HighFreq::get_eigen(scale(mat_rix, scale=FALSE))
rm(eigen_decomp)
ei_gen <- eigen(cov(mat_rix))
in_verse <- HighFreq::inv_reg(mat_rix, max_eigen)
ei_gen$vectors
inverse_r <-  ei_gen$vectors[, 1:max_eigen] %*% (t(ei_gen$vectors[, 1:max_eigen]) / ei_gen$values
)
inverse_r <-  ei_gen$vectors[, 1:max_eigen] %*% (t(ei_gen$vectors[, 1:max_eigen]) / ei_gen$values)
inverse_r
in_verse
all.equal(inverse_r, in_verse)
ei_gen$values
inverse_r <-  ei_gen$vectors[, 1:max_eigen] %*% (t(ei_gen$vectors[, 1:max_eigen]) / ei_gen$values[1:max_eigen])
inverse_r
all.equal(inverse_r, in_verse)
library(HighFreq)
all.equal(in_verse, inverse_r)
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
rm(get_eigen())
rm(get_eigen)
eigen_r <- eigen(cor(mat_rix))
library(HighFreq)
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
system("R CMD Rd2pdf C:/Develop/R/HighFreq")
system("R CMD Rd2pdf C:/Develop/R/HighFreq/vignettes")
?prcomp
